1、Using<br />
<pre style="background: #303030; margin: 0in 0in 0pt;"><span style="font-family: Consolas;"><span style="color: #40c4ff;">using</span><span style="color: #e0e0e0;">&nbsp;</span><span style="color: #eddac0;">System</span><span style="color: silver;">.</span><span style="color: #eddac0;">Runtime</span><span style="color: silver;">.</span><span style="color: #eddac0;">InteropServices</span><span style="color: #e0e0e0;">;</span></span></pre>
2、引用API<br />
<div class="MsoNormal" style="background: #303030; line-height: normal; margin: 0in 0in 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;">
<span style="font-family: Consolas;"><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">[</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: cyan;">DllImport</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">(</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #ff80ff;">"user32.dll"</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">)]</span></span></span></div>
<div class="MsoNormal" style="background: #303030; line-height: normal; margin: 0in 0in 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;">
<span style="font-family: Consolas;"><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #40c4ff;">static</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #40c4ff;">extern</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: cyan;">IntPtr</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #eddac0;">SendMessage</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">(</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: cyan;">IntPtr</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #eddac0;">hWnd</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">, </span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #40c4ff;">uint</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #eddac0;">Msg</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">, </span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: cyan;">IntPtr</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #eddac0;">wParam</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">, </span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: cyan;">IntPtr</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #eddac0;">lParam</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">);</span></span></span></div>
<div class="MsoNormal" style="background: #303030; line-height: normal; margin: 0in 0in 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;">
<span style="font-family: Consolas;"><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #40c4ff;">const</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #40c4ff;">int</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #eddac0;">MONITOR_OFF</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: silver;">=</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #ff80ff;">2</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">;</span></span></span></div>
<div class="MsoNormal" style="background: #303030; line-height: normal; margin: 0in 0in 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;">
<span style="font-family: Consolas;"><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #40c4ff;">const</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #40c4ff;">int</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #eddac0;">SC_MONITORPOWER</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: silver;">=</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #ff80ff;">0xF170</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">;</span></span></span></div>
<div class="MsoNormal" style="background: #303030; line-height: normal; margin: 0in 0in 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;">
<span style="font-family: Consolas;"><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #40c4ff;">const</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #40c4ff;">int</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #eddac0;">WM_SYSCOMMAND</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: silver;">=</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">&nbsp;</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #ff80ff;">0x0112</span></span><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;">;</span></span></span></div>
<div class="MsoNormal" style="background: #303030; line-height: normal; margin: 0in 0in 0pt; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;">
<span style="font-family: Consolas;"><span style="mso-bidi-font-family: 'Courier New'; mso-fareast-font-family: 'Times New Roman';"><span style="color: #e0e0e0;"></span></span></span></div>
3、调用<br />
<pre style="background: #303030; margin: 0in 0in 0pt;"><span style="font-family: Consolas;"><span style="color: #eddac0;">SendMessage</span><span style="color: #e0e0e0;">((</span><span style="color: cyan;">IntPtr</span><span style="color: #e0e0e0;">)</span><span style="color: #ff80ff;">0xffff</span><span style="color: #e0e0e0;">, (</span><span style="color: #40c4ff;">uint</span><span style="color: #e0e0e0;">)</span><span style="color: #eddac0;">WM_SYSCOMMAND</span><span style="color: #e0e0e0;">, (</span><span style="color: cyan;">IntPtr</span><span style="color: #e0e0e0;">)</span><span style="color: #eddac0;">SC_MONITORPOWER</span><span style="color: #e0e0e0;">, (</span><span style="color: cyan;">IntPtr</span><span style="color: #e0e0e0;">)</span><span style="color: #eddac0;">MONITOR_OFF</span><span style="color: #e0e0e0;">);</span></span></pre>
<div class="MsoNormal" style="line-height: 13pt; margin: 0in 0in 10pt;">
<br /></div>
<br />
*使用任何情况（包括没有句柄(handle)的程序(console 等等)）