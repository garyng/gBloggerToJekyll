这是一个比较简短的文章，略略的介绍了YouTube Video Grabber 如何获取YouTube 视频的下载地址等等。<br />
<br />
<strong><u>【写在前面的话】</u></strong><br />
这篇文章，只是提出笔者用来实现YouTube Video Grabber 的思路，不提供代码，组要的原因是让读者动动脑，动动手，这样才能彻底的了解。<br />
还有就是，这个方法不是永远可行的，如果有天YouTube 突然改版了，那这个方法就很可能失效，但是都几乎相同。<br />
<br />
<strong><u>【原理解密】</u></strong><br />
<u>0、获取视频的链接</u><br />
这个不用说，这是一定要的，没有视频链接，要怎么下载？<br />
<br />
<u>1、获取HTML代码</u><br />
获取视频的下载地址呢，首先就必须下载该网页的HTML源代码，这里就以Google Chrome 中直接显示网页的源代码。<br />
<br />
<u>2、获取swf变量</u> <br />
<u></u><br />
有了视频的HTML代码，万事好办了！<br />
YouTube呢，它把所有的视频的链接都储存在这个变量之中，只要找到该变量，就能逐一分析出各个不同分辨率的视频下载链接<br />
只要在HTML代码中搜索<span style="background-color: yellow;">var swf =</span> 就可以看到了：<br />
<a href="http://lh5.ggpht.com/-3ah6OC5q6u8/UM3Yfaw28nI/AAAAAAAAC_0/zXGTtIlmEoU/s1600-h/image%25255B2%25255D.png"><img alt="image" height="345" src="http://lh4.ggpht.com/-_Sxnb6b8M4c/UM3YgT9hkfI/AAAAAAAAC_8/KOmlyJBQJrM/image_thumb.png?imgmax=800" style="display: block; float: none; margin-left: auto; margin-right: auto;" title="image" width="638" /></a><br />
从<span style="background-color: yellow;">var swf =</span>&nbsp; 一直复制到 <span style="background-color: yellow;">document.getElementById('watch7-player').innerHTML = swf;</span><br />
<a href="http://lh5.ggpht.com/-QXQ_2ROdM1U/UM3YhFJ7kxI/AAAAAAAADAA/GgL1NpXMRi0/s1600-h/image%25255B5%25255D.png"><img alt="image" height="434" src="http://lh5.ggpht.com/-DOSSrrq6J78/UM3YiBvf_mI/AAAAAAAADAI/BRH4hdP2Hz8/image_thumb%25255B1%25255D.png?imgmax=800" style="display: block; float: none; margin-left: auto; margin-right: auto;" title="image" width="581" /></a><br />
<br />
复制到任何一个编辑器（笔者用Notepad++），当然里面还有很多我们不需要的东西。<br />
<br />
<u>4、URL解码(URLDecode)</u><br />
复制后，读者们后看到很多类似%2310的字眼，YouTube可能是为了隐藏视频的下载链接，把他们给“编码（Encode）”了，但是，不用怕，这种加密的方法是“可逆”的，就是所有“编码”，就有“解码（Decode）”，就如有“加密（Encrypt）”，就有“解密（Decrypt）”般。<br />
如何解码呢？用特定的解码器！<br />
而解码器，笔者已经为大家准备了！<br />
笔者为了大家的方便，做了个比较容易记的域名：<a href="http://urlendecoder.tk/"><strong><span style="font-size: large;">http://urlendecoder.tk/</span></strong></a><br />
打开上述网页，然后将复制过来的贴到该框框上，然后点击“Decode” <strong><span style="background-color: yellow; color: black;">3次</span></strong><br />
<a href="http://lh3.ggpht.com/-9RniByKvFP4/UM3YjJShVtI/AAAAAAAADAU/kWQbNh9FgkE/s1600-h/image%25255B10%25255D.png"><img alt="image" height="492" src="http://lh6.ggpht.com/-QAgksqCn70Y/UM3YkDN8PrI/AAAAAAAADAc/M8GUJaUXRUs/image_thumb%25255B4%25255D.png?imgmax=800" style="display: block; float: none; margin-left: auto; margin-right: auto;" title="image" width="617" /></a><br />
过后，再次将已经解码了的内容复制到编辑器。<br />
<br />
<u>5、分析下载地址</u><br />
解码后，就可以开始分析下载链接啦！<br />
其实，我们之前复制的代码之中，还掺杂着很多与该视频不相关的资料，我们主要的目的是分析出下载链接。<br />
首先，所有的下载链接都是在<span style="background-color: yellow;">url_encoded_fmt_stream_map </span>后面的，所以我们要做的是：在文本编辑器中搜索<span style="background-color: yellow;">url_encoded_fmt_stream_map</span>，然后去掉之前的部分。<br />
<a href="http://lh5.ggpht.com/-LJaCeqxMXoE/UM3YlcIGuLI/AAAAAAAADAg/JXe5YVjdUC4/s1600-h/image%25255B13%25255D.png"><img alt="image" height="382" src="http://lh5.ggpht.com/-xxkUtwUecss/UM3Ymaiut_I/AAAAAAAADAo/bRO_vGYRpCE/image_thumb%25255B5%25255D.png?imgmax=800" style="display: block; float: none; margin-left: auto; margin-right: auto;" title="image" width="1044" /></a><br />
<br />
各位读者，应该看出什么了吧？之中，所有的视频链接都是以<span style="background-color: yellow;">&amp;url=</span> 分开的，所以我们只要分辨每个&amp;url=，然后把它们分开，视频的下载链接就出来了！<br />
<a href="http://lh5.ggpht.com/-hBgsvc5lSDQ/UM3YnfYyZoI/AAAAAAAADA0/oxxJe2qbi7o/s1600-h/image%25255B16%25255D.png"><img alt="image" height="491" src="http://lh3.ggpht.com/-PG2DZFQXPAo/UM3YopQ3qVI/AAAAAAAADA4/2SYNhaGtiz8/image_thumb%25255B6%25255D.png?imgmax=800" style="display: block; float: none; margin-left: auto; margin-right: auto;" title="image" width="911" /></a><br />
<br />
把他们一个个复制出来：<br />
<a href="http://lh5.ggpht.com/-Ql2AhaPd2q8/UM3YpZd6YAI/AAAAAAAADBA/pUMup-hSEas/s1600-h/image%25255B24%25255D.png"><img alt="image" height="520" src="http://lh3.ggpht.com/-SgqgwNlBNoQ/UM3YrD953WI/AAAAAAAADBM/vw2k0EUZWoQ/image_thumb%25255B10%25255D.png?imgmax=800" style="display: block; float: none; margin-left: auto; margin-right: auto;" title="image" width="1024" /></a><br />
<br />
注意：最后一个下载链接一直到<span style="background-color: yellow;">\u0026</span>为止（就是说，下载链接不包括<span style="background-color: yellow;">\u0026</span>和<span style="background-color: yellow;">\u0026</span>以后的字串）<br />
<br />
<a href="http://lh5.ggpht.com/-eXU_NWorM2s/UM3YsHeL0RI/AAAAAAAADBU/vzKMVZOS7bY/s1600-h/image%25255B19%25255D.png"><img alt="image" height="109" src="http://lh6.ggpht.com/-unk_pjseAwY/UM3YtG-gimI/AAAAAAAADBY/QBeDA-c7m1I/image_thumb%25255B7%25255D.png?imgmax=800" style="display: block; float: none; margin-left: auto; margin-right: auto;" title="image" width="1174" /></a><br />
<br />
<u>6、替换sig</u><br />
最后一个步骤了，YouTube 很“顽皮”地把最重要的<span style="background-color: yellow;">signature</span>换成了<span style="background-color: yellow;">sig</span>，所以如果不直接替换回去的话，就不能下载视频了。<br />
<a href="http://lh6.ggpht.com/-U2gRXwQOtuI/UM3YuT4DdeI/AAAAAAAADBk/uQrNtDbjlfA/s1600-h/image%25255B27%25255D.png"><img alt="image" height="263" src="http://lh3.ggpht.com/-mBVZieLXSBg/UM3YvZpoXrI/AAAAAAAADBo/z9X20T6gYnc/image_thumb%25255B11%25255D.png?imgmax=800" style="display: block; float: none; margin-left: auto; margin-right: auto;" title="image" width="844" /></a><br />
所以要把<span style="background-color: yellow;">sig</span> 替换成 <span style="background-color: yellow;">signature</span><br />
<a href="http://lh6.ggpht.com/-tIjmnVjosG0/UM3YwIgkcpI/AAAAAAAADBw/2fi04F7AEAc/s1600-h/image%25255B30%25255D.png"><img alt="image" height="454" src="http://lh4.ggpht.com/-cZqQboYklMk/UM3YxHy6ifI/AAAAAAAADB4/BjcQ4ouxOH0/image_thumb%25255B12%25255D.png?imgmax=800" style="display: block; float: none; margin-left: auto; margin-right: auto;" title="image" width="902" /></a><br />
<br />
过后，就完成了！<br />
<br />
<strong>【附加信息】</strong><br />
这里来略略解释下视频下载链接的几个比较重要的参数的功能：<br />
以这个链接为例子：<br />
<span style="font-size: x-small;">http://r2---sn-uh-30ar.c.youtube.com/videoplayback?upn=NPuqK12Qg1c&amp;sparams=cp,id,ip,ipbits,itag,ratebypass,source,upn,expire&amp;fexp=900148</span><br />
<span style="font-size: x-small;">,928006,922401,920704,912806,925703,928001,922403,922405,929901,913605,913546,913556,908493,9</span><br />
<span style="font-size: x-small;">08496,920201,913302,919009,914903,911116,910221,901451,902556&amp;key=yt1&amp;expire=13556871</span><br />
<span style="font-size: x-small;">40&amp;<span style="background-color: yellow;"><span style="font-size: medium;">itag=45</span></span>&amp;ipbits=8&amp;sver=3&amp;ratebypass=yes&amp;mt=1355664552&amp;ip=115.132.</span><br />
<span style="font-size: x-small;">86.57&amp;mv=m&amp;source=youtube&amp;ms=au&amp;cp=U0hUSlZTVV9JSkNONF9OTVlCOlhfSGt5RWJrWTc2&amp;a</span><br />
<span style="font-size: x-small;">mp;id=fae9bd59b0dcc824&amp;newshard=yes&amp;</span><span style="background-color: yellow; font-size: medium;">type=video/webm</span><span style="font-size: x-small;">;</span><span style="font-size: x-small;"> codecs="vp8.0,&nbsp;</span><br />
<span style="font-size: x-small;">vorbis"&amp;fallback_host=tc.v19.cache1.c.youtube.com&amp;signature=D33AA12FD27D75BF1D269B235</span><br />
<span style="font-size: x-small;">B2449FF0212E9C5.14C2A0886FF05BFB84B92F08EDBB09146448F191&amp;<span style="background-color: yellow; font-size: medium;">quality=hd720</span>,itag=22</span><br />
<span style="font-size: x-small;"><br /></span>
参数：<br />
<b>itag</b> ： 辨认该下载链接说对应的视频分辨率（YouTube @ Wikipedia 那里有个很详细的itag表<a href="http://en.wikipedia.org/wiki/YouTube#Quality_and_codecs">http://en.wikipedia.org/wiki/YouTube#Quality_and_codecs</a>）<br />
<br />
<b>type</b>： 这就是视频的格式（有flv、webm、3gp、mp4等等）<br />
<br />
<b>quality</b>：这就是视频的质量啦，分为hd1080、hd720、large、medium、small ，分别对应1080p、720p、480p、360p、240p<br />
<br />